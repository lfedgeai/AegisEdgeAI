TPM2_PT_FAMILY_INDICATOR:
  raw: 0x322E3000
  value: "2.0"
TPM2_PT_LEVEL:
  raw: 0
TPM2_PT_REVISION:
  raw: 0xA4
  value: 1.64
TPM2_PT_DAY_OF_YEAR:
  raw: 0x4B
TPM2_PT_YEAR:
  raw: 0x7E5
TPM2_PT_MANUFACTURER:
  raw: 0x49424D00
  value: "IBM"
TPM2_PT_VENDOR_STRING_1:
  raw: 0x53572020
  value: "SW"
TPM2_PT_VENDOR_STRING_2:
  raw: 0x2054504D
  value: "TPM"
TPM2_PT_VENDOR_STRING_3:
  raw: 0x0
  value: ""
TPM2_PT_VENDOR_STRING_4:
  raw: 0x0
  value: ""
TPM2_PT_VENDOR_TPM_TYPE:
  raw: 0x1
TPM2_PT_FIRMWARE_VERSION_1:
  raw: 0x20191023
TPM2_PT_FIRMWARE_VERSION_2:
  raw: 0x163636
TPM2_PT_INPUT_BUFFER:
  raw: 0x400
TPM2_PT_HR_TRANSIENT_MIN:
  raw: 0x3
TPM2_PT_HR_PERSISTENT_MIN:
  raw: 0x7
TPM2_PT_HR_LOADED_MIN:
  raw: 0x3
TPM2_PT_ACTIVE_SESSIONS_MAX:
  raw: 0x40
TPM2_PT_PCR_COUNT:
  raw: 0x18
TPM2_PT_PCR_SELECT_MIN:
  raw: 0x3
TPM2_PT_CONTEXT_GAP_MAX:
  raw: 0xFFFF
TPM2_PT_NV_COUNTERS_MAX:
  raw: 0x0
TPM2_PT_NV_INDEX_MAX:
  raw: 0x800
TPM2_PT_MEMORY:
  raw: 0x6
TPM2_PT_CLOCK_UPDATE:
  raw: 0x1000
TPM2_PT_CONTEXT_HASH:
  raw: 0xD
TPM2_PT_CONTEXT_SYM:
  raw: 0x6
TPM2_PT_CONTEXT_SYM_SIZE:
  raw: 0x100
TPM2_PT_ORDERLY_COUNT:
  raw: 0xFF
TPM2_PT_MAX_COMMAND_SIZE:
  raw: 0x1000
TPM2_PT_MAX_RESPONSE_SIZE:
  raw: 0x1000
TPM2_PT_MAX_DIGEST:
  raw: 0x40
TPM2_PT_MAX_OBJECT_CONTEXT:
  raw: 0xA84
TPM2_PT_MAX_SESSION_CONTEXT:
  raw: 0x194
TPM2_PT_PS_FAMILY_INDICATOR:
  raw: 0x322E3000
TPM2_PT_PS_LEVEL:
  raw: 0x0
TPM2_PT_PS_REVISION:
  raw: 0xA4
TPM2_PT_PS_DAY_OF_YEAR:
  raw: 0x4B
TPM2_PT_PS_YEAR:
  raw: 0x7E5
TPM2_PT_SPLIT_MAX:
  raw: 0x80
TPM2_PT_TOTAL_COMMANDS:
  raw: 0x6E
TPM2_PT_LIBRARY_COMMANDS:
  raw: 0x6E
TPM2_PT_VENDOR_COMMANDS:
  raw: 0x0
TPM2_PT_NV_BUFFER_MAX:
  raw: 0x400
TPM2_PT_MODES:
  raw: 0x0
[STEP] Using TPM2TOOLS_TCTI=swtpm:host=127.0.0.1,port=2321
[STEP] EK handle will be 0x81010001
[STEP] AK handle will be 0x8101000A
[STEP] Flushing transient/session handles...
[STEP] Evicting existing EK/AK persistent handles (if any)...
[INFO] Handle 0x81010001 not listed; forcing eviction to clear phantom state
[INFO] Handle 0x8101000A not listed; forcing eviction to clear phantom state
[STEP] Creating EK...
persistent-handle: 0x81010001
action: persisted
[STEP] Flushing again after EK creation...
[INFO] Flushing handles-transient handle 0x80000000
[INFO] Flushing handles-transient handle 0x80000001
[STEP] Creating AK using EK handle 0x81010001...
loaded-key:
  name: 000b9ae440fb57a0c3b75410b9325f0b1ff3f0f4ecb387d860d45ff38f04df29c41b
  qualified name: 000bb85b25233ccd94461760d0c85260c93e4443fe838d07843764ba068db4ceefdc
persistent-handle: 0x8101000a
action: persisted
[STEP] Exporting AK public key for verification...
name: 000b9ae440fb57a0c3b75410b9325f0b1ff3f0f4ecb387d860d45ff38f04df29c41b
qualified name: 000bb85b25233ccd94461760d0c85260c93e4443fe838d07843764ba068db4ceefdc
name-alg:
  value: sha256
  raw: 0xb
attributes:
  value: fixedtpm|fixedparent|sensitivedataorigin|userwithauth|restricted|sign
  raw: 0x50072
type:
  value: rsa
  raw: 0x1
exponent: 65537
bits: 2048
scheme:
  value: rsassa
  raw: 0x14
scheme-halg:
  value: sha256
  raw: 0xb
sym-alg:
  value: null
  raw: 0x10
sym-mode:
  value: (null)
  raw: 0x0
sym-keybits: 0
rsa: eda23febbe99c5be05db27c19f719e3ae3a5aeef473f5bf4f5bdb52c7bc739b558ec1d644f44e8fdf0353b808336206377f5c75be8a6295a960a930bc6c5d9840c72f139f8997dcf9c300078111b0342d6ca494fc0af835a0a57c5b57bc1b8326d458c39ebb713359d725d5ad0061ecd71108e60c00713e7c6ddc47b96098e5940b602564fc9b031e9d5acc13c892eaf2c01c32ca0653138c931591d883b3758445b50d589462c251004303f2c59faa2570aee382c2aa939b22f4fa733a6ecee25b31dc2d6c1250bbabb8f2f8c089cdab67624e29de95ac79a5996bb46b3d87cb42bc1e089cd9369e0a9aa9ea1dee7eaed08072084a940a559477faec3f4fe57
[SUCCESS] AK Public Key exported to /mnt/c/Users/ramkr/AegisEdgeAI/zero-trust/tpm/ak_pub.pem
[STEP] Persistent handles now present:
- 0x81010001
- 0x8101000A
[INFO] AK handle: 0x8101000A
[INFO] App handle: 0x8101000B
[INFO] Using default TPM files:
[INFO]   Context file: /mnt/c/Users/ramkr/AegisEdgeAI/zero-trust/tpm/app.ctx
[INFO]   Public key: /mnt/c/Users/ramkr/AegisEdgeAI/zero-trust/tpm/appsk_pubkey.pem
[STEP] Flushing ALL stale contexts...
[STEP] Creating primary...
name-alg:
  value: sha256
  raw: 0xb
attributes:
  value: fixedtpm|fixedparent|sensitivedataorigin|userwithauth|restricted|decrypt
  raw: 0x30072
type:
  value: rsa
  raw: 0x1
exponent: 65537
bits: 2048
scheme:
  value: null
  raw: 0x10
scheme-halg:
  value: (null)
  raw: 0x0
sym-alg:
  value: aes
  raw: 0x6
sym-mode:
  value: cfb
  raw: 0x43
sym-keybits: 128
rsa: 8d57d37ea8281d4bbbc2a04b92cad15c6fea30947e2d54f03369128d79a8c77589e47c209f00c19353ddcecd007607b5d4f2381c65dfd661ff5e49c1027d62c473d2108e685093719988786cb0886cd40b3f4a27bda55835f92c7f3ff8ec3923fdf645962df7bf340cab53071bfa7a599352e02398b6e3af4227ddd64a52239047f3a6b455be981b1e39e016b4b830541bb4b9b6fe707ca51593f6d7f7b68a8711bff1c7ad54e5cc7538c70d082730a1258af1956db6bf180537255d35a33c8e6ac63cfe34d4f1d6469848c7d5f241aae31d99a8d35254019485bb6f2e9b96e3c20cad93e341fa6e0d20a7117ab6d3bcf0b887524ce0cc8e311ce30833b30435
[STEP] Creating AppSK under primary...
name-alg:
  value: sha256
  raw: 0xb
attributes:
  value: fixedtpm|fixedparent|sensitivedataorigin|userwithauth|decrypt|sign
  raw: 0x60072
type:
  value: rsa
  raw: 0x1
exponent: 65537
bits: 2048
scheme:
  value: null
  raw: 0x10
scheme-halg:
  value: (null)
  raw: 0x0
sym-alg:
  value: null
  raw: 0x10
sym-mode:
  value: (null)
  raw: 0x0
sym-keybits: 0
rsa: 9f9d7d79cfef80f9c536a53dfaf6ba4b9a66f9989d46bbe710ff391564bea4e6b9deb8d7f49dd771d47643cf2702ef3d9d4c1dd19291085156e55168a119204d6b7246f7453ee41f6f44c6ef3cecd1d911150138676c3268830854d5a4a82bb62d0b3ef06f50f822992e6f9079f55579152b103dc23b83b2ac3de5f118188a23960af98cc773b9e86129444233924a968475d8bfdf8d5d0c02a8eb7bda68ac11d8bc3c4f44faa41d609e23cd0e1701ad95055809c775592cb05a8f0c29104de5633c3eacfb99b2e789b336ed95b706d81ccd1f04c2b8e06cc23ce79e9ebaf3080b2cfafe9edfa5ff918383128c71db52cc6e44874e88cd8932b2fcc29ac2569d
[STEP] Flushing all extra transients...
[STEP] Loading AppSK...
name: 000b8fe8296fdf2d1060606ddbf12a6dc366decedc880144972c48c54e9380754fe6
[DEBUG] AppSK transient handle: 0x80000001
[STEP] Persisting AppSK at 0x8101000B...
persistent-handle: 0x8101000b
action: persisted
[CLEANUP] Flushing primary and any remaining transients...
[DEBUG] Persistent handles now:
- 0x81010001
- 0x8101000A
- 0x8101000B
[STEP] Certifying AppSK with AK at 0x8101000A...
[INFO] Using -o/-s syntax for certify
[INFO] Residency proof written: appsig_info.bin / appsig_cert.sig
[SUCCESS] AppSK persisted at 0x8101000B.
name: 000b8fe8296fdf2d1060606ddbf12a6dc366decedc880144972c48c54e9380754fe6
qualified name: 000bea9c9452a564aff740a27eaaaca51c04eebf849df5845c4ae174c1cd82c1fd08
name-alg:
  value: sha256
  raw: 0xb
attributes:
  value: fixedtpm|fixedparent|sensitivedataorigin|userwithauth|decrypt|sign
  raw: 0x60072
type:
  value: rsa
  raw: 0x1
exponent: 65537
bits: 2048
scheme:
  value: null
  raw: 0x10
scheme-halg:
  value: (null)
  raw: 0x0
sym-alg:
  value: null
  raw: 0x10
sym-mode:
  value: (null)
  raw: 0x0
sym-keybits: 0
rsa: 9f9d7d79cfef80f9c536a53dfaf6ba4b9a66f9989d46bbe710ff391564bea4e6b9deb8d7f49dd771d47643cf2702ef3d9d4c1dd19291085156e55168a119204d6b7246f7453ee41f6f44c6ef3cecd1d911150138676c3268830854d5a4a82bb62d0b3ef06f50f822992e6f9079f55579152b103dc23b83b2ac3de5f118188a23960af98cc773b9e86129444233924a968475d8bfdf8d5d0c02a8eb7bda68ac11d8bc3c4f44faa41d609e23cd0e1701ad95055809c775592cb05a8f0c29104de5633c3eacfb99b2e789b336ed95b706d81ccd1f04c2b8e06cc23ce79e9ebaf3080b2cfafe9edfa5ff918383128c71db52cc6e44874e88cd8932b2fcc29ac2569d
[INFO] Exported TPM public key to /mnt/c/Users/ramkr/AegisEdgeAI/zero-trust/tpm/appsk_pubkey.pem
[INFO] APP certification by AK complete
[INFO] TPM Quote Generation Script
[INFO] TPM2TOOLS_TCTI: swtpm:host=127.0.0.1,port=2321
[INFO] AK handle: 0x8101000A
[INFO] Using nonce: 12
[STEP] Checking if AK exists at handle 0x8101000A...
[STEP] Flushing TPM contexts...
[STEP] Generating TPM quote...
[INFO] Quote will be saved to:
[INFO]   - Message: appsk_quote.msg
[INFO]   - Signature: appsk_quote.sig
[INFO]   - PCRs: appsk_quote.pcrs
quoted: ff54434780180022000bb85b25233ccd94461760d0c85260c93e4443fe838d07843764ba068db4ceefdc00011200000000000012c9000000010000000001201910230016363600000001000b030300000020f5a5fd42d16a20302798ef6ed309979b43003d2320d9f0e8ea9831a92759fb4b
signature:
  alg: rsassa
  sig: 67bfbb31fa8a8d234086386b4f27b1dabfea47404cde47de41a3a09a821453740a38c2894e59490a36215d31b87cdbc7812cb067e0e6b488e74bc03d0cfc4d2376bb1bf19394475a3560bb051e7ab601295675ecf18ef0d1611e7b65365295114d539c8b90a8818faec5d3a89821d5d57d986333fcb73a03178b118f3eff3c82b2f5da0abe28b3900a4ccc4bafb92daafc7ede59bad83b666b55aaea27f64c73872ba6a11ae71435dbcd7316e9162f56cd80440c27c0782269747447ba49f41241adb03a188671e68b73bdda9178b96e8eabe77b38962176da7361078222bc56ae50cbbf6b9273907002ff17ea92ed6524d489a4593ee631765a5b60daaab33f
pcrs:
  sha256:
    0 : 0x0000000000000000000000000000000000000000000000000000000000000000
    1 : 0x0000000000000000000000000000000000000000000000000000000000000000
calcDigest: f5a5fd42d16a20302798ef6ed309979b43003d2320d9f0e8ea9831a92759fb4b
[SUCCESS] TPM quote generated successfully
[INFO] Quote files:
[INFO]   - Message: appsk_quote.msg
[INFO]   - Signature: appsk_quote.sig
[INFO]   - PCRs: appsk_quote.pcrs
[INFO]   - Nonce used: 12
[INFO] Using nonce: 12
[STEP] Verifying TPM quote signature...
pcrs:
  sha256:
    0 : 0x0000000000000000000000000000000000000000000000000000000000000000
    1 : 0x0000000000000000000000000000000000000000000000000000000000000000
sig: 67bfbb31fa8a8d234086386b4f27b1dabfea47404cde47de41a3a09a821453740a38c2894e59490a36215d31b87cdbc7812cb067e0e6b488e74bc03d0cfc4d2376bb1bf19394475a3560bb051e7ab601295675ecf18ef0d1611e7b65365295114d539c8b90a8818faec5d3a89821d5d57d986333fcb73a03178b118f3eff3c82b2f5da0abe28b3900a4ccc4bafb92daafc7ede59bad83b666b55aaea27f64c73872ba6a11ae71435dbcd7316e9162f56cd80440c27c0782269747447ba49f41241adb03a188671e68b73bdda9178b96e8eabe77b38962176da7361078222bc56ae50cbbf6b9273907002ff17ea92ed6524d489a4593ee631765a5b60daaab33f
[SUCCESS] TPM Quote verified successfully
[STEP] Verifying AppSK certification signature...
[SUCCESS] AppSK certification signature verified
[SUCCESS] All verifications completed successfully
[INFO] TPM Quote: VERIFIED
[INFO] AppSK Certification: VERIFIED
[INFO] AppSK public key is now trusted through TPM AK and EK chain
[INFO] Using TPM context file: /mnt/c/Users/ramkr/AegisEdgeAI/zero-trust/tpm/app.ctx
[INFO] Message file already in correct location: /mnt/c/Users/ramkr/AegisEdgeAI/zero-trust/tpm/appsig_info.bin
[INFO] TPM contexts flushed.
[INFO] Generating SHA-256 hash of message to sign...
[INFO] Signing precomputed hash with rsassa scheme...
[INFO] Signature generated: /mnt/c/Users/ramkr/AegisEdgeAI/zero-trust/tpm/appsig.bin
Signature: 1abb999e7834aa304a565d814d483b5e540937729e8beec6eac7af66c658ee6ff9385a8f7f5c1677203f2d56c96f2b2a05ff1f70047d8bea8f5b139e423921771bf078c235d573003413f0f62895c8ee4c48536a5d31ec37442ec2fb101578d10b11eeff8ed88ef9d4557cc1dead4874aee33adf9dd67f0ad0e252dd2b6e2d709b1eec55e2c2228545f5c0615035586333855c4ce411a3163dae09a8e4837d7b691aff57fcd5997784df40c962adef545c0266159f81dba3bbe3819bf90a42bd6f720ed6657142bd9be52c46656a653b1c7af6d3991e72d022a53e1c348ca37f90bcec403db53cb9693a98f4ad325ae5fdd23beb3397fa50d50184aa82e3ee45
Digest: f0db643b8731d284901cb92e433f888a81db4c99ddc85ae3ad63e20ff626d22e
[INFO] Hashing the message with SHA-256...
[INFO] Verifying signature with OpenSSL pkeyutl...
Signature Verified Successfully
[INFO] Signature valid!
🧹 Cleaning up all existing agents...
=====================================
[1;33mNo agent directories found. Nothing to clean up.[0m
