TPM2_PT_FAMILY_INDICATOR:
  raw: 0x322E3000
  value: "2.0"
TPM2_PT_LEVEL:
  raw: 0
TPM2_PT_REVISION:
  raw: 0xA4
  value: 1.64
TPM2_PT_DAY_OF_YEAR:
  raw: 0x4B
TPM2_PT_YEAR:
  raw: 0x7E5
TPM2_PT_MANUFACTURER:
  raw: 0x49424D00
  value: "IBM"
TPM2_PT_VENDOR_STRING_1:
  raw: 0x53572020
  value: "SW"
TPM2_PT_VENDOR_STRING_2:
  raw: 0x2054504D
  value: "TPM"
TPM2_PT_VENDOR_STRING_3:
  raw: 0x0
  value: ""
TPM2_PT_VENDOR_STRING_4:
  raw: 0x0
  value: ""
TPM2_PT_VENDOR_TPM_TYPE:
  raw: 0x1
TPM2_PT_FIRMWARE_VERSION_1:
  raw: 0x20191023
TPM2_PT_FIRMWARE_VERSION_2:
  raw: 0x163636
TPM2_PT_INPUT_BUFFER:
  raw: 0x400
TPM2_PT_HR_TRANSIENT_MIN:
  raw: 0x3
TPM2_PT_HR_PERSISTENT_MIN:
  raw: 0x7
TPM2_PT_HR_LOADED_MIN:
  raw: 0x3
TPM2_PT_ACTIVE_SESSIONS_MAX:
  raw: 0x40
TPM2_PT_PCR_COUNT:
  raw: 0x18
TPM2_PT_PCR_SELECT_MIN:
  raw: 0x3
TPM2_PT_CONTEXT_GAP_MAX:
  raw: 0xFFFF
TPM2_PT_NV_COUNTERS_MAX:
  raw: 0x0
TPM2_PT_NV_INDEX_MAX:
  raw: 0x800
TPM2_PT_MEMORY:
  raw: 0x6
TPM2_PT_CLOCK_UPDATE:
  raw: 0x1000
TPM2_PT_CONTEXT_HASH:
  raw: 0xD
TPM2_PT_CONTEXT_SYM:
  raw: 0x6
TPM2_PT_CONTEXT_SYM_SIZE:
  raw: 0x100
TPM2_PT_ORDERLY_COUNT:
  raw: 0xFF
TPM2_PT_MAX_COMMAND_SIZE:
  raw: 0x1000
TPM2_PT_MAX_RESPONSE_SIZE:
  raw: 0x1000
TPM2_PT_MAX_DIGEST:
  raw: 0x40
TPM2_PT_MAX_OBJECT_CONTEXT:
  raw: 0xA84
TPM2_PT_MAX_SESSION_CONTEXT:
  raw: 0x194
TPM2_PT_PS_FAMILY_INDICATOR:
  raw: 0x322E3000
TPM2_PT_PS_LEVEL:
  raw: 0x0
TPM2_PT_PS_REVISION:
  raw: 0xA4
TPM2_PT_PS_DAY_OF_YEAR:
  raw: 0x4B
TPM2_PT_PS_YEAR:
  raw: 0x7E5
TPM2_PT_SPLIT_MAX:
  raw: 0x80
TPM2_PT_TOTAL_COMMANDS:
  raw: 0x6E
TPM2_PT_LIBRARY_COMMANDS:
  raw: 0x6E
TPM2_PT_VENDOR_COMMANDS:
  raw: 0x0
TPM2_PT_NV_BUFFER_MAX:
  raw: 0x400
TPM2_PT_MODES:
  raw: 0x0
[STEP] Using TPM2TOOLS_TCTI=swtpm:host=127.0.0.1,port=2321
[STEP] EK handle will be 0x81010001
[STEP] AK handle will be 0x8101000A
[STEP] Flushing transient/session handles...
[STEP] Evicting existing EK/AK persistent handles (if any)...
[INFO] Handle 0x81010001 not listed; forcing eviction to clear phantom state
[INFO] Handle 0x8101000A not listed; forcing eviction to clear phantom state
[STEP] Creating EK...
persistent-handle: 0x81010001
action: persisted
[STEP] Flushing again after EK creation...
[INFO] Flushing handles-transient handle 0x80000000
[INFO] Flushing handles-transient handle 0x80000001
[STEP] Creating AK using EK handle 0x81010001...
loaded-key:
  name: 000bbbf817de35ccbbb2d6c25794cb31db0423cccaeefa5b62207da341f12f5ae1c7
  qualified name: 000bab8366c1a97150b4831edbf7d689e0777157649c708568e7d07cf185c0b11bb9
persistent-handle: 0x8101000a
action: persisted
[STEP] Exporting AK public key for verification...
name: 000bbbf817de35ccbbb2d6c25794cb31db0423cccaeefa5b62207da341f12f5ae1c7
qualified name: 000bab8366c1a97150b4831edbf7d689e0777157649c708568e7d07cf185c0b11bb9
name-alg:
  value: sha256
  raw: 0xb
attributes:
  value: fixedtpm|fixedparent|sensitivedataorigin|userwithauth|restricted|sign
  raw: 0x50072
type:
  value: rsa
  raw: 0x1
exponent: 65537
bits: 2048
scheme:
  value: rsassa
  raw: 0x14
scheme-halg:
  value: sha256
  raw: 0xb
sym-alg:
  value: null
  raw: 0x10
sym-mode:
  value: (null)
  raw: 0x0
sym-keybits: 0
rsa: c12672bc2308d6cc541d4fc2ce66adca55a07a99688c0b2650c7789dfb48be9d39d9484603b055de629d3c0adf45f8f0c8ce614cf037a92c0f9b24987851658a3ee98342fcb01b9d9372c1b13b1773d1e4b5e1a1a36351e5fb6a150fbeb9e0b4301cfeadbaaffce13cb5dc0fd713c91f0d42f1959779844d7c9392658857c492908b322199460732ea3a2340cdd45bb2cc0a2803ee6aeb70489f5a838c3b0c905f76f74b9a8e091cd14af181b3ef80819df7563204d1646601f0ae6221826c2cf4d3d44c1164bea4c99f5584b7964d68b83692f6bee07698db5a736ece6b094fe605141e0a23bbe6c523f895e8bcb02341972d4c03c04f97ab7545db0565286b
[SUCCESS] AK Public Key exported to /mnt/c/Users/ramkr/CitadelAI/zero-trust/tpm/ak_pub.pem
[STEP] Persistent handles now present:
- 0x81010001
- 0x8101000A
[INFO] AK handle: 0x8101000A
[INFO] App handle: 0x8101000B
[INFO] Using default TPM files:
[INFO]   Context file: /mnt/c/Users/ramkr/CitadelAI/zero-trust/tpm/app.ctx
[INFO]   Public key: /mnt/c/Users/ramkr/CitadelAI/zero-trust/tpm/appsk_pubkey.pem
[STEP] Flushing ALL stale contexts...
[STEP] Creating primary...
name-alg:
  value: sha256
  raw: 0xb
attributes:
  value: fixedtpm|fixedparent|sensitivedataorigin|userwithauth|restricted|decrypt
  raw: 0x30072
type:
  value: rsa
  raw: 0x1
exponent: 65537
bits: 2048
scheme:
  value: null
  raw: 0x10
scheme-halg:
  value: (null)
  raw: 0x0
sym-alg:
  value: aes
  raw: 0x6
sym-mode:
  value: cfb
  raw: 0x43
sym-keybits: 128
rsa: b34ff9b975c0032345dcf2fc0048903c45b947706830c4d7611cac8740082620fc19736a5d10504d14672427820e81012bb36cee7496442bbe913298f340d2194e1791814974b5a4aa597b60b7cea3c89eac4ca8f6cb81c2a0d3b149a022efab3454ee89b9c85d35b567bc431ccde28c22e35b4a5c54ddae5e5cfeacca8c54ea682bfbfe838376178944ffc2ee93b276c4739a32f819ff29315c0d3a54bca9272e82a6a26af91cac5f50d4bd2817bbef865945174129af477d5f39eff88753dc68a68c8332c0dc741f60aed098e74445371e23ceb0a175bc494d4a4924500cfcfb6f21be415170291970cffa219877fc4bcd623080864c8d1d9440a6347d74ff
[STEP] Creating AppSK under primary...
name-alg:
  value: sha256
  raw: 0xb
attributes:
  value: fixedtpm|fixedparent|sensitivedataorigin|userwithauth|decrypt|sign
  raw: 0x60072
type:
  value: rsa
  raw: 0x1
exponent: 65537
bits: 2048
scheme:
  value: null
  raw: 0x10
scheme-halg:
  value: (null)
  raw: 0x0
sym-alg:
  value: null
  raw: 0x10
sym-mode:
  value: (null)
  raw: 0x0
sym-keybits: 0
rsa: c2b70f1c35a3abff0786ef7f1c4677284856534e7335d97976d733d71821499a3fe6acf38ff6d77dcf7aced1965faf5b2390650c88b85222959911ee8b9d279d55e06e8b5e58dd2ab056fad8a6e5797cc9f3202f3de403901b0690adf6316cdec01fb3e72874aafeb4eba0b3c59077b1d26d779f95a15a48ac5a04b045e64b1cf9b82873ed1c16287d0d667266b8700d09de61fb0dd02d7b2f85b3a8ac1327da6c65b66324d0807613bafd8f1ac8ded14e563c513cec9c5215ca13be9722872ad3c66e90fad3bd2a1b20a4710429bc5bc8738b16548a0ca0cf1ebcd77e96511581ce09c93be41209ffdd537d4e461e622b89e8ecdf08f9ad1e9492b5ee0f7169
[STEP] Flushing all extra transients...
[STEP] Loading AppSK...
name: 000b15660b9bf4f3145f5f6691b3f759e0a6170f2d3d3c97baa22df1e2ab8772c1d1
[DEBUG] AppSK transient handle: 0x80000001
[STEP] Persisting AppSK at 0x8101000B...
persistent-handle: 0x8101000b
action: persisted
[CLEANUP] Flushing primary and any remaining transients...
[DEBUG] Persistent handles now:
- 0x81010001
- 0x8101000A
- 0x8101000B
[STEP] Certifying AppSK with AK at 0x8101000A...
[INFO] Using -o/-s syntax for certify
[INFO] Residency proof written: appsig_info.bin / appsig_cert.sig
[SUCCESS] AppSK persisted at 0x8101000B.
name: 000b15660b9bf4f3145f5f6691b3f759e0a6170f2d3d3c97baa22df1e2ab8772c1d1
qualified name: 000bdbd83db889d5b8a191210b034c53dd2febcad9971afcfdd6d8f7a8fd9736a9a4
name-alg:
  value: sha256
  raw: 0xb
attributes:
  value: fixedtpm|fixedparent|sensitivedataorigin|userwithauth|decrypt|sign
  raw: 0x60072
type:
  value: rsa
  raw: 0x1
exponent: 65537
bits: 2048
scheme:
  value: null
  raw: 0x10
scheme-halg:
  value: (null)
  raw: 0x0
sym-alg:
  value: null
  raw: 0x10
sym-mode:
  value: (null)
  raw: 0x0
sym-keybits: 0
rsa: c2b70f1c35a3abff0786ef7f1c4677284856534e7335d97976d733d71821499a3fe6acf38ff6d77dcf7aced1965faf5b2390650c88b85222959911ee8b9d279d55e06e8b5e58dd2ab056fad8a6e5797cc9f3202f3de403901b0690adf6316cdec01fb3e72874aafeb4eba0b3c59077b1d26d779f95a15a48ac5a04b045e64b1cf9b82873ed1c16287d0d667266b8700d09de61fb0dd02d7b2f85b3a8ac1327da6c65b66324d0807613bafd8f1ac8ded14e563c513cec9c5215ca13be9722872ad3c66e90fad3bd2a1b20a4710429bc5bc8738b16548a0ca0cf1ebcd77e96511581ce09c93be41209ffdd537d4e461e622b89e8ecdf08f9ad1e9492b5ee0f7169
[INFO] Exported TPM public key to /mnt/c/Users/ramkr/CitadelAI/zero-trust/tpm/appsk_pubkey.pem
[INFO] APP certification by AK complete
[INFO] TPM Quote Generation Script
[INFO] TPM2TOOLS_TCTI: swtpm:host=127.0.0.1,port=2321
[INFO] AK handle: 0x8101000A
[INFO] Using nonce: 12
[STEP] Checking if AK exists at handle 0x8101000A...
[STEP] Flushing TPM contexts...
[STEP] Generating TPM quote...
[INFO] Quote will be saved to:
[INFO]   - Message: appsk_quote.msg
[INFO]   - Signature: appsk_quote.sig
[INFO]   - PCRs: appsk_quote.pcrs
quoted: ff54434780180022000bab8366c1a97150b4831edbf7d689e0777157649c708568e7d07cf185c0b11bb90001120000000000001438000000010000000001201910230016363600000001000b030300000020f5a5fd42d16a20302798ef6ed309979b43003d2320d9f0e8ea9831a92759fb4b
signature:
  alg: rsassa
  sig: 84494942f836773de6e301f1c11dfaa0a523d6d73bd1350d2a1f4c4fb8d2f1898182530778b2187dc66c377a0d945498a8639f1dee3c54fc56d9c4383bc514357d4f9a7c304a2657b23979d98206b84c5ac71bbacaebd1a6cf953d9caa52e9825d8e4bad0e34eed2763ac3171897dbc4bf473a1b0e6fa5fb39954af95bb8e8e957cfa0bc480bbece1e98bbc9ad06f85eb90ba18a17844ef397e7bd22d1aed4b8884331fa1c41b52e400b545afbc658cdbc466f3b2833f7e36b1ed6fbc1be970ce9c90e73b7250a37c9713bad96dc8556e5918e863b47e7beba7409a9673397a366df7a30b0ed292096d00e30f56db77198e57cbbc28127fcdcc3bfdae7ef91a1
pcrs:
  sha256:
    0 : 0x0000000000000000000000000000000000000000000000000000000000000000
    1 : 0x0000000000000000000000000000000000000000000000000000000000000000
calcDigest: f5a5fd42d16a20302798ef6ed309979b43003d2320d9f0e8ea9831a92759fb4b
[SUCCESS] TPM quote generated successfully
[INFO] Quote files:
[INFO]   - Message: appsk_quote.msg
[INFO]   - Signature: appsk_quote.sig
[INFO]   - PCRs: appsk_quote.pcrs
[INFO]   - Nonce used: 12
[INFO] Using nonce: 12
[STEP] Verifying TPM quote signature...
pcrs:
  sha256:
    0 : 0x0000000000000000000000000000000000000000000000000000000000000000
    1 : 0x0000000000000000000000000000000000000000000000000000000000000000
sig: 84494942f836773de6e301f1c11dfaa0a523d6d73bd1350d2a1f4c4fb8d2f1898182530778b2187dc66c377a0d945498a8639f1dee3c54fc56d9c4383bc514357d4f9a7c304a2657b23979d98206b84c5ac71bbacaebd1a6cf953d9caa52e9825d8e4bad0e34eed2763ac3171897dbc4bf473a1b0e6fa5fb39954af95bb8e8e957cfa0bc480bbece1e98bbc9ad06f85eb90ba18a17844ef397e7bd22d1aed4b8884331fa1c41b52e400b545afbc658cdbc466f3b2833f7e36b1ed6fbc1be970ce9c90e73b7250a37c9713bad96dc8556e5918e863b47e7beba7409a9673397a366df7a30b0ed292096d00e30f56db77198e57cbbc28127fcdcc3bfdae7ef91a1
[SUCCESS] TPM Quote verified successfully
[STEP] Verifying AppSK certification signature...
[SUCCESS] AppSK certification signature verified
[SUCCESS] All verifications completed successfully
[INFO] TPM Quote: VERIFIED
[INFO] AppSK Certification: VERIFIED
[INFO] AppSK public key is now trusted through TPM AK and EK chain
[INFO] Using TPM context file: /mnt/c/Users/ramkr/CitadelAI/zero-trust/tpm/app.ctx
[INFO] Message file already in correct location: /mnt/c/Users/ramkr/CitadelAI/zero-trust/tpm/appsig_info.bin
[INFO] TPM contexts flushed.
[INFO] Generating SHA-256 hash of message to sign...
[INFO] Signing precomputed hash with rsassa scheme...
[INFO] Signature generated: /mnt/c/Users/ramkr/CitadelAI/zero-trust/tpm/appsig.bin
Signature: a7c5ef502f6b6da9483bb4b759c7cf47dae29b59e0d22a00a284cadb3181b2d0bea1999f5dbb8f123a4bf737074c433cd5511d97abeeb55f5141518ffc9206f911b5508cada91dc08059494a95bf3384a67522dafb23b1322832c3ef8891c30abdce586650de2092ef4ded250003368ee60f2458b7b9a80081c6a7bb04170acd1c9eddec1da0ef80e5598fe35958a54e96f1561a96988da08882dd980cb895a2c8a6c4ca05947023b4de82230d6f7c802403c7042da73254d49efb9643c78dbd77a24cb92483aa0e14a28861154d7c576bfe73a3d6edddd923ec78e355c6a65b7ef5ea39d387fc3d37e59124954c46502e69b67733026c37a45bfa4028f355eb
Digest: 7bfaab4badcf8047858eb33da791ee075ffb76b9e74fba265ac878b151c386b7
[INFO] Hashing the message with SHA-256...
[INFO] Verifying signature with OpenSSL pkeyutl...
Signature Verified Successfully
[INFO] Signature valid!
ðŸ§¹ Cleaning up all existing agents...
=====================================
[1;33mNo agent directories found. Nothing to clean up.[0m
