INFO:__main__:[2m2025-08-27T01:00:25.466243Z[0m [[32m[1minfo     [0m] [1mGateway logging configuration [0m [[34m[1m__main__[0m] [36mdebug_all[0m=[35mFalse[0m [36mdebug_gateway[0m=[35mFalse[0m [36mlog_level[0m=[35mINFO[0m
INFO:__main__:[2m2025-08-27T01:00:25.475719Z[0m [[32m[1minfo     [0m] [1mSkipping OpenTelemetry metrics setup for compatibility[0m [[34m[1m__main__[0m] 
INFO:__main__:[2m2025-08-27T01:00:25.476667Z[0m [[32m[1minfo     [0m] [1mOpenTelemetry setup completed (OTLP export disabled)[0m [[34m[1m__main__[0m] 
INFO:__main__:[2m2025-08-27T01:00:25.482394Z[0m [[32m[1minfo     [0m] [1mGateway allowlist loaded      [0m [[34m[1m__main__[0m] [36magent_count[0m=[35m2[0m [36mpath[0m=[35mgateway/allowed_agents.json[0m
INFO:__main__:[2m2025-08-27T01:00:25.482860Z[0m [[32m[1minfo     [0m] [1mGateway allowlist manager initialized[0m [[34m[1m__main__[0m] [36magent_count[0m=[35m2[0m [36mallowlist_path[0m=[35mgateway/allowed_agents.json[0m [36mvalidate_geolocation[0m=[35mTrue[0m [36mvalidate_public_key_hash[0m=[35mTrue[0m [36mvalidate_signature[0m=[35mTrue[0m
INFO:__main__:[2m2025-08-27T01:00:25.512995Z[0m [[32m[1minfo     [0m] [1mGenerated temporary SSL certificates[0m [[34m[1m__main__[0m] [36mcert_path[0m=[35m/tmp/tmp319flbt_.pem[0m [36mkey_path[0m=[35m/tmp/tmpi_5ghw1s.pem[0m
 * Serving Flask app 'app'
 * Debug mode: off
INFO:__main__:[2m2025-08-27T01:00:27.474928Z[0m [[32m[1minfo     [0m] [1mGateway received headers (nonce)[0m [[34m[1m__main__[0m] [36msignature[0m=[35mNone[0m [36msignature_input[0m=[35mkeyid="0ccf697aea599b067225b7d34d245264d734c2125ba931b039c4e97b4bbd46b1", created=1756256427, expires=1756256727, alg="Ed25519", nonce="dd92f978bc8c63242742247e5613cbc2"[0m [36mworkload_geo_id[0m=[35mNone[0m
INFO:__main__:[2m2025-08-27T01:00:27.477247Z[0m [[32m[1minfo     [0m] [1mSecurityManager validating nonce request - public key hash only[0m [[34m[1m__main__[0m] 
INFO:__main__:[2m2025-08-27T01:00:27.477586Z[0m [[32m[1minfo     [0m] [1m‚úÖ [GATEWAY] Nonce validation passed - public key hash only[0m [[34m[1m__main__[0m] 
INFO:__main__:[2m2025-08-27T01:00:27.495599Z[0m [[32m[1minfo     [0m] [1mNonce request proxied successfully[0m [[34m[1m__main__[0m] 
INFO:__main__:[2m2025-08-27T01:00:27.624873Z[0m [[32m[1minfo     [0m] [1mGateway received headers (metrics)[0m [[34m[1m__main__[0m] [36msignature[0m=[35m73092ce46b35f514afdcffa5f6343844...[0m [36msignature_input[0m=[35mkeyid="0ccf697aea599b067225b7d34d245264d734c2125ba931b039c4e97b4bbd46b1", created=1756256427, expires=1756256727, alg="Ed25519", nonce="67eed4d330ba87f7a7349dbf63094f5a"[0m [36mworkload_geo_id[0m=[35m{"client_workload_id":"agent-001","client_workload_location":{"region":"US","state":"California","city":"Santa Clara"},"client_workload_location_type":"geographic-region","client_workload_location_quality":"GNSS","client_type":"thick"}[0m
INFO:__main__:[2m2025-08-27T01:00:27.627052Z[0m [[32m[1minfo     [0m] [1mSecurityManager checking validation conditions for non-nonce request[0m [[34m[1m__main__[0m] [36mvalidate_geolocation[0m=[35mTrue[0m [36mvalidate_public_key_hash[0m=[35mTrue[0m [36mvalidate_signature[0m=[35mTrue[0m
INFO:__main__:[2m2025-08-27T01:00:27.627276Z[0m [[32m[1minfo     [0m] [1mSecurityManager calling validate_request_headers[0m [[34m[1m__main__[0m] 
INFO:__main__:[2m2025-08-27T01:00:27.627476Z[0m [[32m[1minfo     [0m] [1mGateway validate_request_headers called[0m [[34m[1m__main__[0m] [36mheaders_present[0m=[35m['Host', 'User-Agent', 'Accept-Encoding', 'Accept', 'Connection', 'Content-Type', 'Workload-Geo-Id', 'Signature-Input', 'Signature', 'Content-Length', 'Traceparent'][0m [36mvalidate_geolocation[0m=[35mTrue[0m
INFO:__main__:[2m2025-08-27T01:00:27.627692Z[0m [[32m[1minfo     [0m] [1mSignature validation passed (basic format check)[0m [[34m[1m__main__[0m] [36magent_name[0m=[35magent-001[0m [36mpublic_key_hash[0m=[35m0ccf697aea599b067225b7d34d245264d734c2125ba931b039c4e97b4bbd46b1[0m
INFO:__main__:[2m2025-08-27T01:00:27.627917Z[0m [[32m[1minfo     [0m] [1mGateway checking geolocation validation[0m [[34m[1m__main__[0m] [36mvalidate_geolocation[0m=[35mTrue[0m [36mworkload_geo_id_str[0m=[35m{"client_workload_id":"agent-001","client_workload_location":{"region":"US","state":"California","city":"Santa Clara"},"client_workload_location_type":"geographic-region","client_workload_location_quality":"GNSS","client_type":"thick"}[0m
INFO:__main__:[2m2025-08-27T01:00:27.628104Z[0m [[32m[1minfo     [0m] [1mGateway geolocation validation called[0m [[34m[1m__main__[0m] [36mpublic_key_hash[0m=[35m0ccf697aea599b067225b7d34d245264d734c2125ba931b039c4e97b4bbd46b1[0m [36mworkload_geo_id[0m=[35m{'client_workload_id': 'agent-001', 'client_workload_location': {'region': 'US', 'state': 'California', 'city': 'Santa Clara'}, 'client_workload_location_type': 'geographic-region', 'client_workload_location_quality': 'GNSS', 'client_type': 'thick'}[0m
INFO:__main__:[2m2025-08-27T01:00:27.628283Z[0m [[32m[1minfo     [0m] [1mGateway geolocation comparison[0m [[34m[1m__main__[0m] [36mactual_city[0m=[35mSANTA CLARA[0m [36mactual_country[0m=[35mUS[0m [36mactual_state[0m=[35mCALIFORNIA[0m [36magent_name[0m=[35magent-001[0m [36mexpected_city[0m=[35mSANTA CLARA[0m [36mexpected_country[0m=[35mUS[0m [36mexpected_state[0m=[35mCALIFORNIA[0m
INFO:__main__:[2m2025-08-27T01:00:27.628451Z[0m [[32m[1minfo     [0m] [1mGeolocation validation passed [0m [[34m[1m__main__[0m] [36mactual_geo[0m=[35m{'region': 'US', 'state': 'California', 'city': 'Santa Clara'}[0m [36magent_name[0m=[35magent-001[0m [36mexpected_geo[0m=[35m{'country': 'US', 'state': 'California', 'city': 'Santa Clara'}[0m
INFO:__main__:[2m2025-08-27T01:00:27.628615Z[0m [[32m[1minfo     [0m] [1mGateway geolocation validation result[0m [[34m[1m__main__[0m] [36mvalidation_result[0m=[35m{'valid': True, 'agent': {'agent_name': 'agent-001', 'tpm_public_key': 'MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAp5GAG3YbAWdlScF9vDGbIN6tOlAhdWpzmAz5epBgI2DtPok/hHYZsWUJIvXt9l1ZG+olML/9Gk7Y4IlKJ5LJbu8Cur1fqyTuyGxU7XUmzqrJKYBMhuS8rPHcktNLTDJO6h2EerevuUIGuzMvM45WmFolWR69nTrKBJd2ceyooGFMUk5/Fzg3Xbgh4P0wgT2DhUg1h7xU0TfT5bczH9XRdgu2XO6UTfB7+YqHrRIh8Qj+ZzKVZETbB9G+sSWxs/SCk4WnWNSGcOcY3A2WuYUCOsktMnV5WPZfUHI5w89xLCc4WFp/t5TT4ohM95E+Qw3XKm77kbSfhjLIAp9SB+J4jQIDAQAB', 'tpm_public_key_hash': '0ccf697aea599b067225b7d34d245264d734c2125ba931b039c4e97b4bbd46b1', 'geolocation': {'country': 'US', 'state': 'California', 'city': 'Santa Clara'}, 'status': 'active', 'created_at': '2025-08-15T18:00:00Z'}, 'reason': 'Geolocation validation passed'}[0m
INFO:__main__:[2m2025-08-27T01:00:27.628769Z[0m [[32m[1minfo     [0m] [1mSecurityManager validation result[0m [[34m[1m__main__[0m] [36mvalidation_result[0m=[35m{'valid': True, 'agent': {'agent_name': 'agent-001', 'tpm_public_key': 'MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAp5GAG3YbAWdlScF9vDGbIN6tOlAhdWpzmAz5epBgI2DtPok/hHYZsWUJIvXt9l1ZG+olML/9Gk7Y4IlKJ5LJbu8Cur1fqyTuyGxU7XUmzqrJKYBMhuS8rPHcktNLTDJO6h2EerevuUIGuzMvM45WmFolWR69nTrKBJd2ceyooGFMUk5/Fzg3Xbgh4P0wgT2DhUg1h7xU0TfT5bczH9XRdgu2XO6UTfB7+YqHrRIh8Qj+ZzKVZETbB9G+sSWxs/SCk4WnWNSGcOcY3A2WuYUCOsktMnV5WPZfUHI5w89xLCc4WFp/t5TT4ohM95E+Qw3XKm77kbSfhjLIAp9SB+J4jQIDAQAB', 'tpm_public_key_hash': '0ccf697aea599b067225b7d34d245264d734c2125ba931b039c4e97b4bbd46b1', 'geolocation': {'country': 'US', 'state': 'California', 'city': 'Santa Clara'}, 'status': 'active', 'created_at': '2025-08-15T18:00:00Z'}, 'reason': 'All validations passed'}[0m
INFO:__main__:[2m2025-08-27T01:00:27.678807Z[0m [[32m[1minfo     [0m] [1mMetrics request proxied successfully[0m [[34m[1m__main__[0m] 
INFO:__main__:[2m2025-08-27T01:00:27.729286Z[0m [[32m[1minfo     [0m] [1mGateway received headers (nonce)[0m [[34m[1m__main__[0m] [36msignature[0m=[35mNone[0m [36msignature_input[0m=[35mkeyid="ff3940f898216333453cef415abfedcaab5b7342b1886ba769f71c622cfd6353", created=1756256427, expires=1756256727, alg="Ed25519", nonce="3de5d803d0a0a758a1955ed059ca8f69"[0m [36mworkload_geo_id[0m=[35mNone[0m
INFO:__main__:[2m2025-08-27T01:00:27.732003Z[0m [[32m[1minfo     [0m] [1mSecurityManager validating nonce request - public key hash only[0m [[34m[1m__main__[0m] 
INFO:__main__:[2m2025-08-27T01:00:27.732361Z[0m [[32m[1minfo     [0m] [1m‚úÖ [GATEWAY] Nonce validation passed - public key hash only[0m [[34m[1m__main__[0m] 
INFO:__main__:[2m2025-08-27T01:00:27.749058Z[0m [[32m[1minfo     [0m] [1mNonce request proxied successfully[0m [[34m[1m__main__[0m] 
INFO:__main__:[2m2025-08-27T01:00:27.860915Z[0m [[32m[1minfo     [0m] [1mGateway received headers (metrics)[0m [[34m[1m__main__[0m] [36msignature[0m=[35m84df1171a9a8164506dcf6b681e045dc...[0m [36msignature_input[0m=[35mkeyid="ff3940f898216333453cef415abfedcaab5b7342b1886ba769f71c622cfd6353", created=1756256427, expires=1756256727, alg="Ed25519", nonce="de6e9cea9a75bd6d2a3566b0addf38a7"[0m [36mworkload_geo_id[0m=[35m{"client_workload_id":"agent-geo-policy-violation-002","client_workload_location":{"region":"EU","state":"Germany","city":"Berlin"},"client_workload_location_type":"geographic-region","client_workload_location_quality":"GNSS","client_type":"thick"}[0m
INFO:__main__:[2m2025-08-27T01:00:27.862813Z[0m [[32m[1minfo     [0m] [1mSecurityManager checking validation conditions for non-nonce request[0m [[34m[1m__main__[0m] [36mvalidate_geolocation[0m=[35mTrue[0m [36mvalidate_public_key_hash[0m=[35mTrue[0m [36mvalidate_signature[0m=[35mTrue[0m
INFO:__main__:[2m2025-08-27T01:00:27.863021Z[0m [[32m[1minfo     [0m] [1mSecurityManager calling validate_request_headers[0m [[34m[1m__main__[0m] 
INFO:__main__:[2m2025-08-27T01:00:27.863212Z[0m [[32m[1minfo     [0m] [1mGateway validate_request_headers called[0m [[34m[1m__main__[0m] [36mheaders_present[0m=[35m['Host', 'User-Agent', 'Accept-Encoding', 'Accept', 'Connection', 'Content-Type', 'Workload-Geo-Id', 'Signature-Input', 'Signature', 'Content-Length', 'Traceparent'][0m [36mvalidate_geolocation[0m=[35mTrue[0m
INFO:__main__:[2m2025-08-27T01:00:27.863385Z[0m [[32m[1minfo     [0m] [1mSignature validation passed (basic format check)[0m [[34m[1m__main__[0m] [36magent_name[0m=[35magent-geo-policy-violation-002[0m [36mpublic_key_hash[0m=[35mff3940f898216333453cef415abfedcaab5b7342b1886ba769f71c622cfd6353[0m
INFO:__main__:[2m2025-08-27T01:00:27.863544Z[0m [[32m[1minfo     [0m] [1mGateway checking geolocation validation[0m [[34m[1m__main__[0m] [36mvalidate_geolocation[0m=[35mTrue[0m [36mworkload_geo_id_str[0m=[35m{"client_workload_id":"agent-geo-policy-violation-002","client_workload_location":{"region":"EU","state":"Germany","city":"Berlin"},"client_workload_location_type":"geographic-region","client_workload_location_quality":"GNSS","client_type":"thick"}[0m
INFO:__main__:[2m2025-08-27T01:00:27.863716Z[0m [[32m[1minfo     [0m] [1mGateway geolocation validation called[0m [[34m[1m__main__[0m] [36mpublic_key_hash[0m=[35mff3940f898216333453cef415abfedcaab5b7342b1886ba769f71c622cfd6353[0m [36mworkload_geo_id[0m=[35m{'client_workload_id': 'agent-geo-policy-violation-002', 'client_workload_location': {'region': 'EU', 'state': 'Germany', 'city': 'Berlin'}, 'client_workload_location_type': 'geographic-region', 'client_workload_location_quality': 'GNSS', 'client_type': 'thick'}[0m
INFO:__main__:[2m2025-08-27T01:00:27.863886Z[0m [[32m[1minfo     [0m] [1mGateway geolocation comparison[0m [[34m[1m__main__[0m] [36mactual_city[0m=[35mBERLIN[0m [36mactual_country[0m=[35mEU[0m [36mactual_state[0m=[35mGERMANY[0m [36magent_name[0m=[35magent-geo-policy-violation-002[0m [36mexpected_city[0m=[35mSANTA CLARA[0m [36mexpected_country[0m=[35mUS[0m [36mexpected_state[0m=[35mCALIFORNIA[0m
WARNING:__main__:[2m2025-08-27T01:00:27.864055Z[0m [[33m[1mwarning  [0m] [1mGateway geolocation validation result[0m [[34m[1m__main__[0m] [36mvalidation_result[0m=[35m{'valid': False, 'reason': 'Geolocation verification failed', 'details': {'expected': {'country': 'US', 'state': 'California', 'city': 'Santa Clara'}, 'received': {'region': 'EU', 'state': 'Germany', 'city': 'Berlin'}, 'agent_name': 'agent-geo-policy-violation-002'}}[0m
WARNING:__main__:[2m2025-08-27T01:00:27.864228Z[0m [[33m[1mwarning  [0m] [1mSecurityManager validation result[0m [[34m[1m__main__[0m] [36mvalidation_result[0m=[35m{'valid': False, 'reason': 'Geolocation verification failed', 'details': {'expected': {'country': 'US', 'state': 'California', 'city': 'Santa Clara'}, 'received': {'region': 'EU', 'state': 'Germany', 'city': 'Berlin'}, 'agent_name': 'agent-geo-policy-violation-002'}}[0m
INFO:__main__:[2m2025-08-27T01:00:27.958851Z[0m [[32m[1minfo     [0m] [1mGateway received headers (nonce)[0m [[34m[1m__main__[0m] [36msignature[0m=[35mNone[0m [36msignature_input[0m=[35mkeyid="2796d33dcbdc5464e11991a09229c90a6d2c610bc6d32fdb379106b639e921db", created=1756256427, expires=1756256727, alg="Ed25519", nonce="9feea53a7118a22d975fcad4ec623053"[0m [36mworkload_geo_id[0m=[35mNone[0m
INFO:__main__:[2m2025-08-27T01:00:27.961254Z[0m [[32m[1minfo     [0m] [1mSecurityManager validating nonce request - public key hash only[0m [[34m[1m__main__[0m] 
WARNING:__main__:[2m2025-08-27T01:00:27.961502Z[0m [[33m[1mwarning  [0m] [1m‚ùå [GATEWAY] Nonce request from unauthorized agent[0m [[34m[1m__main__[0m] [36magent_public_key_hash[0m=[35m2796d33dcbdc5464...[0m [36mrequest_ip[0m=[35m127.0.0.1[0m
