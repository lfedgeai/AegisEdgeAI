INFO:agent.app:[2m2025-08-26T21:28:02.905863Z[0m [[32m[1minfo     [0m] [1mAgent logging configuration   [0m [[34m[1magent.app[0m] [36mdebug_agent[0m=[35mFalse[0m [36mdebug_all[0m=[35mFalse[0m [36mlog_level[0m=[35mINFO[0m
INFO:agent.app:[2m2025-08-26T21:28:02.919003Z[0m [[32m[1minfo     [0m] [1mUsing agent-specific TPM context file[0m [[34m[1magent.app[0m] [36magent_name[0m=[35magent-unregistered-003[0m [36mcontext_path[0m=[35mtpm/agent-unregistered-003.ctx[0m
INFO:utils.tpm2_utils:[2m2025-08-26T21:28:02.922955Z[0m [[32m[1minfo     [0m] [1mSoftware TPM (swtpm) is accessible[0m [[34m[1mutils.tpm2_utils[0m] 
INFO:agent.app:[2m2025-08-26T21:28:02.927340Z[0m [[32m[1minfo     [0m] [1mTPM2 utilities initialized successfully[0m [[34m[1magent.app[0m] [36magent_name[0m=[35magent-unregistered-003[0m [36mcontext_path[0m=[35mtpm/agent-unregistered-003.ctx[0m [36muse_swtpm[0m=[35mTrue[0m
INFO:agent.app:[2m2025-08-26T21:28:02.934057Z[0m [[32m[1minfo     [0m] [1mSkipping OpenTelemetry metrics setup for compatibility[0m [[34m[1magent.app[0m] 
INFO:agent.app:[2m2025-08-26T21:28:02.934959Z[0m [[32m[1minfo     [0m] [1mOpenTelemetry setup completed (OTLP export disabled)[0m [[34m[1magent.app[0m] 
ğŸš€ Starting agent: agent-unregistered-003
ğŸ“ Config file: agents/agent-unregistered-003/config.json
ğŸŒ Agent port: 8403
ğŸ” APP_HANDLE: 0x8101000D
ğŸ”— Gateway: localhost:9000
ğŸ“Š Collector: localhost:8500
 * Serving Flask app 'agent.app'
 * Debug mode: off
INFO:agent.app:[2m2025-08-26T21:28:03.739441Z[0m [[32m[1minfo     [0m] [1mğŸ”„ [AGENT] Initiating nonce retrieval for metrics[0m [[34m[1magent.app[0m] [36magent_name[0m=[35magent-unregistered-003[0m [36mmetric_type[0m=[35mapplication[0m
INFO:agent.app:[2m2025-08-26T21:28:03.739811Z[0m [[32m[1minfo     [0m] [1mğŸ”„ [AGENT] Starting nonce request[0m [[34m[1magent.app[0m] [36magent_name[0m=[35magent-unregistered-003[0m [36mconfig_path[0m=[35magents/agent-unregistered-003/config.json[0m [36mgateway_url[0m=[35mhttps://localhost:9000[0m
INFO:agent.app:[2m2025-08-26T21:28:03.743756Z[0m [[32m[1minfo     [0m] [1mğŸ“¤ [AGENT] Sending nonce request to gateway[0m [[34m[1magent.app[0m] [36magent_name[0m=[35magent-unregistered-003[0m [36mpublic_key_hash[0m=[35m3beed6b7dbcc637c...[0m
INFO:agent.app:[2m2025-08-26T21:28:03.744061Z[0m [[32m[1minfo     [0m] [1mğŸ” [AGENT] Signature-Input header created[0m [[34m[1magent.app[0m] [36magent_name[0m=[35magent-unregistered-003[0m [36msignature_input[0m=[35mkeyid="3beed6b7dbcc637c664d86ead8662fdde4f1d384aa716a92cac2102bcaddcacf", created=1756243683, expires=1756243983, alg="Ed25519", nonce="e9bb8514f8142233e1951ee6303d38b0"[0m
INFO:agent.app:[2m2025-08-26T21:28:03.744262Z[0m [[32m[1minfo     [0m] [1mğŸ” [AGENT] Geographic region check[0m [[34m[1magent.app[0m] [36magent_name[0m=[35magent-unregistered-003[0m [36mgeo_env_var[0m=[35mNone[0m
INFO:agent.app:[2m2025-08-26T21:28:03.744398Z[0m [[32m[1minfo     [0m] [1mğŸ” [AGENT] Geographic region determined[0m [[34m[1magent.app[0m] [36magent_name[0m=[35magent-unregistered-003[0m [36mgeographic_region[0m=[35m{'region': 'US', 'state': 'California', 'city': 'Santa Clara'}[0m
INFO:agent.app:[2m2025-08-26T21:28:03.744652Z[0m [[32m[1minfo     [0m] [1mğŸ“¤ [AGENT] Sending nonce request with Workload-Geo-ID[0m [[34m[1magent.app[0m] [36magent_name[0m=[35magent-unregistered-003[0m [36mworkload_geo_id[0m=[35m{'client_workload_id': 'agent-unregistered-003', 'client_workload_location': {'region': 'US', 'state': 'California', 'city': 'Santa Clara'}, 'client_workload_location_type': 'geographic-region', 'client_workload_location_quality': 'GNSS', 'client_type': 'thick'}[0m
INFO:agent.app:[2m2025-08-26T21:28:03.744843Z[0m [[32m[1minfo     [0m] [1mğŸ“¤ [AGENT] Final headers for nonce request[0m [[34m[1magent.app[0m] [36magent_name[0m=[35magent-unregistered-003[0m [36mheaders[0m=[35m{'Signature-Input': 'keyid="3beed6b7dbcc637c664d86ead8662fdde4f1d384aa716a92cac2102bcaddcacf", created=1756243683, expires=1756243983, alg="Ed25519", nonce="e9bb8514f8142233e1951ee6303d38b0"', 'Workload-Geo-ID': '{"client_workload_id":"agent-unregistered-003","client_workload_location":{"region":"US","state":"California","city":"Santa Clara"},"client_workload_location_type":"geographic-region","client_workload_location_quality":"GNSS","client_type":"thick"}'}[0m
ERROR:agent.app:[2m2025-08-26T21:28:03.763908Z[0m [[31m[1merror    [0m] [1mâŒ [AGENT] HTTP error from collector during nonce request[0m [[34m[1magent.app[0m] [36merror_details[0m=[35mPublic key hash 3beed6b7dbcc637c664d86ead8662fdde4f1d384aa716a92cac2102bcaddcacf not found in allowlist[0m [36mresponse_text[0m=[35m{"error":"Public key hash 3beed6b7dbcc637c664d86ead8662fdde4f1d384aa716a92cac2102bcaddcacf not found in allowlist"}
[0m [36mstatus_code[0m=[35m403[0m
ERROR:agent.app:[2m2025-08-26T21:28:03.779370Z[0m [[31m[1merror    [0m] [1mâŒ [AGENT] Nonce request failed[0m [[34m[1magent.app[0m] [36merror[0m=[35mNonce request failed: Public key hash 3beed6b7dbcc637c664d86ead8662fdde4f1d384aa716a92cac2102bcaddcacf not found in allowlist[0m
