=== RUN   TestBatchNewX509SVID_WithSovereignAttestation
=== RUN   TestBatchNewX509SVID_WithSovereignAttestation/success_with_valid_sovereign_attestation
time="2025-11-05T02:43:19+01:00" level=info msg="Unified-Identity - Phase 1: Processing sovereign attestation request (stubbed Keylime)" has_app_key=true has_app_key_cert=true has_tpm_quote=true nonce=test-nonce-123 workload_code_hash=
time="2025-11-05T02:43:19+01:00" level=info msg="Unified-Identity - Phase 1: Using stubbed Keylime Verifier (returning fixed claims)"
time="2025-11-05T02:43:19+01:00" level=info msg="Unified-Identity - Phase 1: Returning stubbed attested claims from Keylime Verifier" geolocation="Spain: N40.4168, W3.7038" gpu_memory_mb=10240 gpu_status=healthy gpu_utilization=15 host_integrity=PASSED_ALL_CHECKS
=== RUN   TestBatchNewX509SVID_WithSovereignAttestation/policy_violation_denies_SVID
time="2025-11-05T02:43:19+01:00" level=info msg="Unified-Identity - Phase 1: Processing sovereign attestation request (stubbed Keylime)" has_app_key=true has_app_key_cert=true has_tpm_quote=true nonce=test-nonce-123 workload_code_hash=
time="2025-11-05T02:43:19+01:00" level=info msg="Unified-Identity - Phase 1: Using stubbed Keylime Verifier (returning fixed claims)"
time="2025-11-05T02:43:19+01:00" level=info msg="Unified-Identity - Phase 1: Returning stubbed attested claims from Keylime Verifier" geolocation="Spain: N40.4168, W3.7038" gpu_memory_mb=10240 gpu_status=healthy gpu_utilization=15 host_integrity=PASSED_ALL_CHECKS
    server.go:126: Gracefully stopping gRPC server
    server.go:128: Server stopped
    server.go:130: Server serve returned <nil>
    server.go:122: Waiting for handlers to drain
    server.go:124: Handlers drained
=== RUN   TestBatchNewX509SVID_WithSovereignAttestation/invalid_sovereign_attestation_format
=== RUN   TestBatchNewX509SVID_WithSovereignAttestation/no_sovereign_attestation_-_normal_flow
=== NAME  TestBatchNewX509SVID_WithSovereignAttestation
    server.go:126: Gracefully stopping gRPC server
    server.go:128: Server stopped
    server.go:130: Server serve returned <nil>
    server.go:122: Waiting for handlers to drain
    server.go:124: Handlers drained
    server.go:126: Gracefully stopping gRPC server
    server.go:128: Server stopped
    server.go:130: Server serve returned <nil>
    server.go:122: Waiting for handlers to drain
    server.go:124: Handlers drained
--- PASS: TestBatchNewX509SVID_WithSovereignAttestation (0.05s)
    --- PASS: TestBatchNewX509SVID_WithSovereignAttestation/success_with_valid_sovereign_attestation (0.01s)
    --- PASS: TestBatchNewX509SVID_WithSovereignAttestation/policy_violation_denies_SVID (0.00s)
    --- PASS: TestBatchNewX509SVID_WithSovereignAttestation/invalid_sovereign_attestation_format (0.00s)
    --- PASS: TestBatchNewX509SVID_WithSovereignAttestation/no_sovereign_attestation_-_normal_flow (0.00s)
=== RUN   TestBatchNewX509SVID_FeatureFlagDisabled
    server.go:126: Gracefully stopping gRPC server
    server.go:128: Server stopped
    server.go:130: Server serve returned <nil>
    server.go:122: Waiting for handlers to drain
    server.go:124: Handlers drained
    server.go:126: Gracefully stopping gRPC server
    server.go:128: Server stopped
    server.go:130: Server serve returned <nil>
    server.go:122: Waiting for handlers to drain
    server.go:124: Handlers drained
--- PASS: TestBatchNewX509SVID_FeatureFlagDisabled (0.01s)
=== RUN   TestServiceMintX509SVID
=== RUN   TestServiceMintX509SVID/success
=== RUN   TestServiceMintX509SVID/custom_ttl
=== RUN   TestServiceMintX509SVID/custom_dns
=== RUN   TestServiceMintX509SVID/custom_subject
=== RUN   TestServiceMintX509SVID/custom_subject_and_dns
=== RUN   TestServiceMintX509SVID/no_CSR
=== RUN   TestServiceMintX509SVID/malformed_CSR
=== RUN   TestServiceMintX509SVID/invalid_signature
=== RUN   TestServiceMintX509SVID/no_URIs
=== RUN   TestServiceMintX509SVID/multiple_URIs
=== RUN   TestServiceMintX509SVID/invalid_SPIFFE_ID
=== RUN   TestServiceMintX509SVID/different_trust_domain
=== RUN   TestServiceMintX509SVID/SPIFFE_ID_is_not_for_a_workload_in_the_trust_domain
=== RUN   TestServiceMintX509SVID/invalid_DNS
=== RUN   TestServiceMintX509SVID/signing_fails
=== NAME  TestServiceMintX509SVID
    server.go:126: Gracefully stopping gRPC server
    server.go:128: Server stopped
    server.go:130: Server serve returned <nil>
    server.go:122: Waiting for handlers to drain
    server.go:124: Handlers drained
--- PASS: TestServiceMintX509SVID (0.04s)
    --- PASS: TestServiceMintX509SVID/success (0.00s)
    --- PASS: TestServiceMintX509SVID/custom_ttl (0.00s)
    --- PASS: TestServiceMintX509SVID/custom_dns (0.00s)
    --- PASS: TestServiceMintX509SVID/custom_subject (0.00s)
    --- PASS: TestServiceMintX509SVID/custom_subject_and_dns (0.00s)
    --- PASS: TestServiceMintX509SVID/no_CSR (0.00s)
    --- PASS: TestServiceMintX509SVID/malformed_CSR (0.00s)
    --- PASS: TestServiceMintX509SVID/invalid_signature (0.00s)
    --- PASS: TestServiceMintX509SVID/no_URIs (0.00s)
    --- PASS: TestServiceMintX509SVID/multiple_URIs (0.00s)
    --- PASS: TestServiceMintX509SVID/invalid_SPIFFE_ID (0.00s)
    --- PASS: TestServiceMintX509SVID/different_trust_domain (0.00s)
    --- PASS: TestServiceMintX509SVID/SPIFFE_ID_is_not_for_a_workload_in_the_trust_domain (0.00s)
    --- PASS: TestServiceMintX509SVID/invalid_DNS (0.00s)
    --- PASS: TestServiceMintX509SVID/signing_fails (0.00s)
=== RUN   TestServiceMintJWTSVID
=== RUN   TestServiceMintJWTSVID/success
=== RUN   TestServiceMintJWTSVID/success_custom_TTL
=== RUN   TestServiceMintJWTSVID/bad_id
=== RUN   TestServiceMintJWTSVID/invalid_trust_domain
=== RUN   TestServiceMintJWTSVID/SPIFFE_ID_is_not_for_a_workload_in_the_trust_domain
=== RUN   TestServiceMintJWTSVID/no_audience
=== RUN   TestServiceMintJWTSVID/fails_minting
=== NAME  TestServiceMintJWTSVID
    server.go:126: Gracefully stopping gRPC server
    server.go:128: Server stopped
    server.go:130: Server serve returned <nil>
    server.go:122: Waiting for handlers to drain
    server.go:124: Handlers drained
--- PASS: TestServiceMintJWTSVID (0.02s)
    --- PASS: TestServiceMintJWTSVID/success (0.00s)
    --- PASS: TestServiceMintJWTSVID/success_custom_TTL (0.00s)
    --- PASS: TestServiceMintJWTSVID/bad_id (0.00s)
    --- PASS: TestServiceMintJWTSVID/invalid_trust_domain (0.00s)
    --- PASS: TestServiceMintJWTSVID/SPIFFE_ID_is_not_for_a_workload_in_the_trust_domain (0.00s)
    --- PASS: TestServiceMintJWTSVID/no_audience (0.00s)
    --- PASS: TestServiceMintJWTSVID/fails_minting (0.00s)
=== RUN   TestServiceNewJWTSVID
=== RUN   TestServiceNewJWTSVID/success
=== RUN   TestServiceNewJWTSVID/success_custom_TTL
=== RUN   TestServiceNewJWTSVID/success_custom_JWT_TTL
=== RUN   TestServiceNewJWTSVID/no_SPIFFE_ID
=== RUN   TestServiceNewJWTSVID/no_audience
=== RUN   TestServiceNewJWTSVID/no_caller_id
=== RUN   TestServiceNewJWTSVID/rate_limit_fails
=== RUN   TestServiceNewJWTSVID/entry_not_found
=== RUN   TestServiceNewJWTSVID/fails_minting
=== NAME  TestServiceNewJWTSVID
    server.go:126: Gracefully stopping gRPC server
    server.go:128: Server stopped
    server.go:130: Server serve returned <nil>
    server.go:122: Waiting for handlers to drain
    server.go:124: Handlers drained
--- PASS: TestServiceNewJWTSVID (0.02s)
    --- PASS: TestServiceNewJWTSVID/success (0.00s)
    --- PASS: TestServiceNewJWTSVID/success_custom_TTL (0.00s)
    --- PASS: TestServiceNewJWTSVID/success_custom_JWT_TTL (0.00s)
    --- PASS: TestServiceNewJWTSVID/no_SPIFFE_ID (0.00s)
    --- PASS: TestServiceNewJWTSVID/no_audience (0.00s)
    --- PASS: TestServiceNewJWTSVID/no_caller_id (0.00s)
    --- PASS: TestServiceNewJWTSVID/rate_limit_fails (0.00s)
    --- PASS: TestServiceNewJWTSVID/entry_not_found (0.00s)
    --- PASS: TestServiceNewJWTSVID/fails_minting (0.00s)
=== RUN   TestServiceBatchNewX509SVID
=== RUN   TestServiceBatchNewX509SVID/success
=== RUN   TestServiceBatchNewX509SVID/custom_ttl
=== RUN   TestServiceBatchNewX509SVID/custom_x509_ttl
=== RUN   TestServiceBatchNewX509SVID/custom_dns
=== RUN   TestServiceBatchNewX509SVID/keep_request_order
=== RUN   TestServiceBatchNewX509SVID/no_caller_id
=== RUN   TestServiceBatchNewX509SVID/no_parameters
=== RUN   TestServiceBatchNewX509SVID/rate_limit_fails
=== RUN   TestServiceBatchNewX509SVID/fetch_entries_fails
=== RUN   TestServiceBatchNewX509SVID/missing_entry_ID
=== RUN   TestServiceBatchNewX509SVID/missing_CSR
=== RUN   TestServiceBatchNewX509SVID/entry_not_found
=== RUN   TestServiceBatchNewX509SVID/malformed_CSR
=== RUN   TestServiceBatchNewX509SVID/invalid_signature
=== RUN   TestServiceBatchNewX509SVID/malformed_SPIFFE_ID
=== RUN   TestServiceBatchNewX509SVID/signing_fails
=== NAME  TestServiceBatchNewX509SVID
    server.go:126: Gracefully stopping gRPC server
    server.go:128: Server stopped
    server.go:130: Server serve returned <nil>
    server.go:122: Waiting for handlers to drain
    server.go:124: Handlers drained
--- PASS: TestServiceBatchNewX509SVID (0.04s)
    --- PASS: TestServiceBatchNewX509SVID/success (0.01s)
    --- PASS: TestServiceBatchNewX509SVID/custom_ttl (0.00s)
    --- PASS: TestServiceBatchNewX509SVID/custom_x509_ttl (0.00s)
    --- PASS: TestServiceBatchNewX509SVID/custom_dns (0.00s)
    --- PASS: TestServiceBatchNewX509SVID/keep_request_order (0.01s)
    --- PASS: TestServiceBatchNewX509SVID/no_caller_id (0.00s)
    --- PASS: TestServiceBatchNewX509SVID/no_parameters (0.00s)
    --- PASS: TestServiceBatchNewX509SVID/rate_limit_fails (0.00s)
    --- PASS: TestServiceBatchNewX509SVID/fetch_entries_fails (0.00s)
    --- PASS: TestServiceBatchNewX509SVID/missing_entry_ID (0.00s)
    --- PASS: TestServiceBatchNewX509SVID/missing_CSR (0.00s)
    --- PASS: TestServiceBatchNewX509SVID/entry_not_found (0.00s)
    --- PASS: TestServiceBatchNewX509SVID/malformed_CSR (0.00s)
    --- PASS: TestServiceBatchNewX509SVID/invalid_signature (0.00s)
    --- PASS: TestServiceBatchNewX509SVID/malformed_SPIFFE_ID (0.00s)
    --- PASS: TestServiceBatchNewX509SVID/signing_fails (0.00s)
=== RUN   TestNewDownstreamX509CA
=== RUN   TestNewDownstreamX509CA/Malformed_CSR
=== RUN   TestNewDownstreamX509CA/Rate_Limiter_Err
=== RUN   TestNewDownstreamX509CA/Unauthorized
=== RUN   TestNewDownstreamX509CA/Fail_Data_Store
=== RUN   TestNewDownstreamX509CA/Successful_CA_Request
=== NAME  TestNewDownstreamX509CA
    server.go:126: Gracefully stopping gRPC server
    server.go:128: Server stopped
    server.go:130: Server serve returned <nil>
    server.go:122: Waiting for handlers to drain
    server.go:124: Handlers drained
--- PASS: TestNewDownstreamX509CA (0.01s)
    --- PASS: TestNewDownstreamX509CA/Malformed_CSR (0.00s)
    --- PASS: TestNewDownstreamX509CA/Rate_Limiter_Err (0.00s)
    --- PASS: TestNewDownstreamX509CA/Unauthorized (0.00s)
    --- PASS: TestNewDownstreamX509CA/Fail_Data_Store (0.00s)
    --- PASS: TestNewDownstreamX509CA/Successful_CA_Request (0.00s)
PASS
ok  	github.com/spiffe/spire/pkg/server/api/svid/v1	(cached)
